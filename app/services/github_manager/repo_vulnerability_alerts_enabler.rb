module GithubManager
    class RepoVulnerabilityAlertsEnabler < ApplicationService
        def initialize(repo_name)
            @base_url = ENV['GITHUB_API_BASE_URL']
            @username = ENV['GITHUB_USERNAME']
            @password = ENV['GITHUB_ACCESS_TOKEN']
            @repo_name = repo_name
        end

        def call
            HTTParty.put("#{@base_url}/repos/#{@username}/#{@repo_name}/vulnerability-alerts",
                :headers => {:accept => 'application/vnd.github.dorian-preview+json'}, 
                :basic_auth => {:username => @username , :password => @password }
            )
        end
    end
end